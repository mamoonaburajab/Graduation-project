{"ast":null,"code":"import React,{useEffect,useState}from\"react\";import{Space,Table,Tag,Button,message,Tabs}from\"antd\";import\"./ViewAppointments.css\";import NavbarM from\"../navbarMom/NavbarM\";import axios from\"axios\";// Helper function to format dates\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";const formatDate=dateString=>{const date=new Date(dateString);return date.toLocaleDateString(\"en-US\");// Adjust the locale and options as needed\n};// Helper function to get the day of the week\nconst getDayOfWeek=dateString=>{const date=new Date(dateString);return date.toLocaleDateString(\"ar-EG\",{weekday:\"long\"});// 'ar-EG' for Arabic day names\n};const getStatusTag=status=>{switch(status){case 0:return/*#__PURE__*/_jsx(Tag,{color:\"volcano\",children:\"\\u0645\\u0644\\u063A\\u0627\\u0629\"});// Cancelled\ncase 1:return/*#__PURE__*/_jsx(Tag,{color:\"green\",children:\"\\u0645\\u0643\\u062A\\u0645\\u0644\\u0629\"});// Done\ndefault:return/*#__PURE__*/_jsx(Tag,{color:\"geekblue\",children:\"\\u0642\\u0627\\u062F\\u0645\"});// Upcoming\n}};const ViewAppointments=()=>{const[appointments,setAppointments]=useState({upcomingAppointments:[],pastAppointments:[]});const[activeTab,setActiveTab]=useState(\"upcoming\");// State to manage the active tab\nconst motherId=localStorage.getItem(\"userId\");// Assuming mother's ID is stored in local storage\nuseEffect(()=>{const fetchAppointments=async()=>{try{const response=await axios.post(\"http://localhost:4504/Mother/ViewApp\",{motherId}// Sending motherId in the request body\n);const formattedData={upcomingAppointments:response.data.upcomingAppointments.map(appointment=>({...appointment,date:formatDate(appointment.date),day:getDayOfWeek(appointment.date),time:appointment.Time,// Assuming time is in the format \"HH:MM:SS\"\nstatus:appointment.status// Adding status\n})),pastAppointments:response.data.pastAppointments.map(appointment=>({...appointment,date:formatDate(appointment.date),day:getDayOfWeek(appointment.date),time:appointment.Time,// Assuming time is in the format \"HH:MM:SS\"\nstatus:appointment.status// Adding status\n}))};setAppointments(formattedData);}catch(error){console.error(\"Error fetching appointments:\",error);}};fetchAppointments();},[motherId]);const handleDelete=async key=>{try{await axios.delete(\"http://localhost:4504/Mother/ViewApp/\".concat(key));message.success(\"Appointment deleted successfully\");setAppointments(prevAppointments=>({...prevAppointments,upcomingAppointments:prevAppointments.upcomingAppointments.filter(appointment=>appointment.id!==key),pastAppointments:prevAppointments.pastAppointments.filter(appointment=>appointment.id!==key)}));}catch(error){console.error(\"Error deleting appointment:\",error);message.error(\"Failed to delete appointment\");}};const upcomingColumns=[{title:\"الإجراءات\",// Actions\nkey:\"actions\",dataIndex:\"actions\",render:(_,record)=>/*#__PURE__*/_jsx(Space,{size:\"middle\",children:/*#__PURE__*/_jsx(Button,{type:\"link\",onClick:()=>handleDelete(record.id),children:\"\\u062D\\u0630\\u0641\"})}),fixed:\"left\"// This will fix the column to the left\n},{title:\"حالة الموعد\",key:\"status\",dataIndex:\"status\",render:status=>getStatusTag(status)},{title:\"الوقت\",dataIndex:\"time\",key:\"time\"},{title:\"اليوم\",dataIndex:\"day\",key:\"day\"},{title:\"التاريخ\",dataIndex:\"date\",key:\"date\"}];const pastColumns=[{title:\"حالة الموعد\",key:\"status\",dataIndex:\"status\",render:status=>getStatusTag(status)},{title:\"الوقت\",dataIndex:\"time\",key:\"time\"},{title:\"اليوم\",dataIndex:\"day\",key:\"day\"},{title:\"التاريخ\",dataIndex:\"date\",key:\"date\"}];return/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(NavbarM,{}),/*#__PURE__*/_jsx(\"div\",{className:\"tabs-container\",children:/*#__PURE__*/_jsxs(Tabs,{defaultActiveKey:\"upcoming\",onChange:setActiveTab,children:[/*#__PURE__*/_jsx(Tabs.TabPane,{tab:\"\\u0627\\u0644\\u0645\\u0648\\u0627\\u0639\\u064A\\u062F \\u0627\\u0644\\u0642\\u0627\\u062F\\u0645\\u0629\",children:/*#__PURE__*/_jsx(Table,{columns:upcomingColumns,dataSource:appointments.upcomingAppointments,scroll:{x:1000},rowKey:\"id\",loading:!appointments.upcomingAppointments.length// Show loading indicator until data is loaded\n})},\"upcoming\"),/*#__PURE__*/_jsx(Tabs.TabPane,{tab:\"\\u0627\\u0644\\u0645\\u0648\\u0627\\u0639\\u064A\\u062F \\u0627\\u0644\\u0633\\u0627\\u0628\\u0642\\u0629\",className:\"\",children:/*#__PURE__*/_jsx(Table,{columns:pastColumns,dataSource:appointments.pastAppointments,scroll:{x:1000},rowKey:\"id\",loading:!appointments.pastAppointments.length// Show loading indicator until data is loaded\n})},\"past\")]})}),/*#__PURE__*/_jsx(\"div\",{className:\"table-container\"})]});};export default ViewAppointments;","map":{"version":3,"names":["React","useEffect","useState","Space","Table","Tag","Button","message","Tabs","NavbarM","axios","jsx","_jsx","jsxs","_jsxs","formatDate","dateString","date","Date","toLocaleDateString","getDayOfWeek","weekday","getStatusTag","status","color","children","ViewAppointments","appointments","setAppointments","upcomingAppointments","pastAppointments","activeTab","setActiveTab","motherId","localStorage","getItem","fetchAppointments","response","post","formattedData","data","map","appointment","day","time","Time","error","console","handleDelete","key","delete","concat","success","prevAppointments","filter","id","upcomingColumns","title","dataIndex","render","_","record","size","type","onClick","fixed","pastColumns","className","defaultActiveKey","onChange","TabPane","tab","columns","dataSource","scroll","x","rowKey","loading","length"],"sources":["/home/mamoon/graduation folder/graduation/src/component/ViewAppointments/ViewAppointments.jsx"],"sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { Space, Table, Tag, Button, message, Tabs } from \"antd\";\nimport \"./ViewAppointments.css\";\nimport NavbarM from \"../navbarMom/NavbarM\";\nimport axios from \"axios\";\n\n// Helper function to format dates\nconst formatDate = (dateString) => {\n  const date = new Date(dateString);\n  return date.toLocaleDateString(\"en-US\"); // Adjust the locale and options as needed\n};\n\n// Helper function to get the day of the week\nconst getDayOfWeek = (dateString) => {\n  const date = new Date(dateString);\n  return date.toLocaleDateString(\"ar-EG\", { weekday: \"long\" }); // 'ar-EG' for Arabic day names\n};\n\nconst getStatusTag = (status) => {\n  switch (status) {\n    case 0:\n      return <Tag color=\"volcano\">ملغاة</Tag>; // Cancelled\n    case 1:\n      return <Tag color=\"green\">مكتملة</Tag>; // Done\n    default:\n      return <Tag color=\"geekblue\">قادم</Tag>; // Upcoming\n  }\n};\n\nconst ViewAppointments = () => {\n  const [appointments, setAppointments] = useState({\n    upcomingAppointments: [],\n    pastAppointments: [],\n  });\n  const [activeTab, setActiveTab] = useState(\"upcoming\"); // State to manage the active tab\n  const motherId = localStorage.getItem(\"userId\"); // Assuming mother's ID is stored in local storage\n\n  useEffect(() => {\n    const fetchAppointments = async () => {\n      try {\n        const response = await axios.post(\n          `http://localhost:4504/Mother/ViewApp`,\n          { motherId } // Sending motherId in the request body\n        );\n        const formattedData = {\n          upcomingAppointments: response.data.upcomingAppointments.map(\n            (appointment) => ({\n              ...appointment,\n              date: formatDate(appointment.date),\n              day: getDayOfWeek(appointment.date),\n              time: appointment.Time, // Assuming time is in the format \"HH:MM:SS\"\n              status: appointment.status, // Adding status\n            })\n          ),\n          pastAppointments: response.data.pastAppointments.map(\n            (appointment) => ({\n              ...appointment,\n              date: formatDate(appointment.date),\n              day: getDayOfWeek(appointment.date),\n              time: appointment.Time, // Assuming time is in the format \"HH:MM:SS\"\n              status: appointment.status, // Adding status\n            })\n          ),\n        };\n        setAppointments(formattedData);\n      } catch (error) {\n        console.error(\"Error fetching appointments:\", error);\n      }\n    };\n\n    fetchAppointments();\n  }, [motherId]);\n\n  const handleDelete = async (key) => {\n    try {\n      await axios.delete(`http://localhost:4504/Mother/ViewApp/${key}`);\n      message.success(\"Appointment deleted successfully\");\n      setAppointments((prevAppointments) => ({\n        ...prevAppointments,\n        upcomingAppointments: prevAppointments.upcomingAppointments.filter(\n          (appointment) => appointment.id !== key\n        ),\n        pastAppointments: prevAppointments.pastAppointments.filter(\n          (appointment) => appointment.id !== key\n        ),\n      }));\n    } catch (error) {\n      console.error(\"Error deleting appointment:\", error);\n      message.error(\"Failed to delete appointment\");\n    }\n  };\n\n  const upcomingColumns = [\n    {\n      title: \"الإجراءات\", // Actions\n      key: \"actions\",\n      dataIndex: \"actions\",\n      render: (_, record) => (\n        <Space size=\"middle\">\n          <Button type=\"link\" onClick={() => handleDelete(record.id)}>\n            حذف\n          </Button>\n        </Space>\n      ),\n      fixed: \"left\", // This will fix the column to the left\n    },\n    {\n      title: \"حالة الموعد\",\n      key: \"status\",\n      dataIndex: \"status\",\n      render: (status) => getStatusTag(status),\n    },\n    {\n      title: \"الوقت\",\n      dataIndex: \"time\",\n      key: \"time\",\n    },\n    {\n      title: \"اليوم\",\n      dataIndex: \"day\",\n      key: \"day\",\n    },\n    {\n      title: \"التاريخ\",\n      dataIndex: \"date\",\n      key: \"date\",\n    },\n  ];\n\n  const pastColumns = [\n    {\n      title: \"حالة الموعد\",\n      key: \"status\",\n      dataIndex: \"status\",\n      render: (status) => getStatusTag(status),\n    },\n    {\n      title: \"الوقت\",\n      dataIndex: \"time\",\n      key: \"time\",\n    },\n    {\n      title: \"اليوم\",\n      dataIndex: \"day\",\n      key: \"day\",\n    },\n    {\n      title: \"التاريخ\",\n      dataIndex: \"date\",\n      key: \"date\",\n    },\n  ];\n\n  return (\n    <div className=\"container\">\n      <NavbarM />\n      <div className=\"tabs-container\">\n        <Tabs defaultActiveKey=\"upcoming\" onChange={setActiveTab}>\n          <Tabs.TabPane tab=\"المواعيد القادمة\" key=\"upcoming\">\n            <Table\n              columns={upcomingColumns}\n              dataSource={appointments.upcomingAppointments}\n              scroll={{ x: 1000 }}\n              rowKey=\"id\"\n              loading={!appointments.upcomingAppointments.length} // Show loading indicator until data is loaded\n            />\n          </Tabs.TabPane>\n          <Tabs.TabPane tab=\"المواعيد السابقة\" key=\"past\" className=\"\">\n            <Table\n              columns={pastColumns}\n              dataSource={appointments.pastAppointments}\n              scroll={{ x: 1000 }}\n              rowKey=\"id\"\n              loading={!appointments.pastAppointments.length} // Show loading indicator until data is loaded\n            />\n          </Tabs.TabPane>\n        </Tabs>\n      </div>\n      <div className=\"table-container\">\n        {/* Empty div to maintain the structure */}\n      </div>\n    </div>\n  );\n};\n\nexport default ViewAppointments;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}